-- ESP Script with Rainbow Beam and Box, Toggle with "B" key, and Load Notification

local Players = game:GetService("Players")

local RunService = game:GetService("RunService")

local UserInputService = game:GetService("UserInputService")

local LocalPlayer = Players.LocalPlayer

local Camera = workspace.CurrentCamera

local ESPEnabled = false

local ESPFolder = Instance.new("Folder", game.CoreGui)

ESPFolder.Name = "RainbowESP"

-- Rainbow color generator

local function getRainbowColor()

    local time = tick() * 5

    local r = math.sin(time) * 0.5 + 0.5

    local g = math.sin(time + 2) * 0.5 + 0.5

    local b = math.sin(time + 4) * 0.5 + 0.5

    return Color3.new(r, g, b)

end

-- Create ESP elements for a player

local function createESP(player)

    if not player.Character then return end

    local char = player.Character

    local rootPart = char:FindFirstChild("HumanoidRootPart")

    local humanoid = char:FindFirstChildOfClass("Humanoid")

    if not rootPart or not humanoid then return end

    local box = Instance.new("BoxHandleAdornment")

    box.Adornee = rootPart

    box.AlwaysOnTop = true

    box.ZIndex = 10

    box.Transparency = 0.5

    box.Size = Vector3.new(4, 6, 2)

    box.Color3 = Color3.new(1, 1, 1)

    box.Parent = ESPFolder

    local beamPart = Instance.new("Part")

    beamPart.Name = "ESPBeamPart"

    beamPart.Anchored = true

    beamPart.CanCollide = false

    beamPart.Transparency = 1

    beamPart.Size = Vector3.new(0.2, 0.2, 0.2)

    beamPart.Parent = ESPFolder

    local beam = Instance.new("Beam")

    beam.Name = "RainbowBeam"

    beam.Attachment0 = Instance.new("Attachment", Camera)

    beam.Attachment1 = Instance.new("Attachment", beamPart)

    beam.FaceCamera = true

    beam.Width0 = 0.1

    beam.Width1 = 0.1

    beam.LightEmission = 1

    beam.Parent = ESPFolder

    return {

        box = box,

        beamPart = beamPart,

        beam = beam,

        attachment0 = beam.Attachment0,

        attachment1 = beam.Attachment1,

        rootPart = rootPart,

        humanoid = humanoid

    }

end

local ESPPlayers = {}

-- Function to update ESP every frame

local function updateESP()

    for player, espData in pairs(ESPPlayers) do

        if player.Character and player.Character:FindFirstChild("HumanoidRootPart") and player.Character:FindFirstChildOfClass("Humanoid") then

            local rootPart = player.Character.HumanoidRootPart

            local humanoid = player.Character:FindFirstChildOfClass("Humanoid")

            -- Update box position and size based on character

            espData.box.Adornee = rootPart

            espData.box.Size = Vector3.new(4, humanoid.HipHeight * 2 + 2, 2)

            -- Update beam position

            espData.beamPart.CFrame = rootPart.CFrame

            -- Update rainbow color

            local color = getRainbowColor()

            espData.box.Color3 = color

            espData.beam.Color = ColorSequence.new(color)

            -- Enable or disable adornments based on ESP toggle

            espData.box.Visible = ESPEnabled

            espData.beam.Enabled = ESPEnabled

            espData.beamPart.Transparency = ESPEnabled and 1 or 1 -- beamPart invisible but needed for beam

        else

            -- Character lost, remove ESP

            if espData.box then espData.box:Destroy() end

            if espData.beam then espData.beam:Destroy() end

            if espData.beamPart then espData.beamPart:Destroy() end

            ESPPlayers[player] = nil

        end

    end

end

-- Connect player character added to create ESP

local function onCharacterAdded(character)

    local player = Players:GetPlayerFromCharacter(character)

    if player and player ~= LocalPlayer then

        wait(0.1)

        if ESPEnabled then

            ESPPlayers[player] = createESP(player)

        end

    end

end

-- Connect new player added

Players.PlayerAdded:Connect(function(player)

    player.CharacterAdded:Connect(onCharacterAdded)

end)

-- Initialize ESP for players already in the game

for _, player in pairs(Players:GetPlayers()) do

    if player ~= LocalPlayer then

        if player.Character then

            ESPPlayers[player] = createESP(player)

        end

        player.CharacterAdded:Connect(onCharacterAdded)

    end

end

-- Toggle ESP function

local function toggleESP()

    ESPEnabled = not ESPEnabled

    if ESPEnabled then

        -- Create ESP for all players

        for _, player in pairs(Players:GetPlayers()) do

            if player ~= LocalPlayer and player.Character and not ESPPlayers[player] then

                ESPPlayers[player] = createESP(player)

            end

        end

    else

        -- Remove all ESP adornments

        for player, espData in pairs(ESPPlayers) do

            if espData.box then espData.box.Visible = false end

            if espData.beam then espData.beam.Enabled = false end

        end

    end

end

-- Keybind listener

UserInputService.InputBegan:Connect(function(input, gameProcessed)

    if gameProcessed then return end

    if input.KeyCode == Enum.KeyCode.B then

        toggleESP()

    end

end)

-- RunService update loop

RunService.RenderStepped:Connect(function()

    if ESPEnabled then

        updateESP()

    end

end)

-- Notify loaded

game.StarterGui:SetCore("ChatMakeSystemMessage", {

    Text = "sk8kid loaded",

    Color = Color3.fromRGB(100, 255, 100),

    Font = Enum.Font.SourceSansBold,

    FontSize = Enum.FontSize.Size24

})

